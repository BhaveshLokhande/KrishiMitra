<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agri Knowledge Base - Pune Region</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --primary:#2e7d32;
  --secondary:#f4f4f4;
  --accent:#1976d2;
  --danger:#c62828;
  --warning:#f9a825;
}

*{box-sizing:border-box;margin:0;padding:0;font-family:Arial, sans-serif;}
body{background:#fafafa;color:#333;}

header{
  background:var(--primary);
  color:white;
  padding:1rem;
  display:flex;
  flex-direction:column;
  gap:0.5rem;
}

header h1{font-size:1.2rem;}

.top-controls{
  display:flex;
  gap:0.5rem;
}

header input{
  padding:0.5rem;
  border:none;
  border-radius:4px;
  flex:1;
}

.lang-toggle{
  background:white;
  color:var(--primary);
  border:none;
  border-radius:4px;
  padding:0.5rem;
  cursor:pointer;
  font-weight:bold;
}

.container{display:flex;flex-direction:column;}

.sidebar{
  background:white;
  padding:1rem;
  border-bottom:1px solid #ddd;
}

.sidebar h3{margin-bottom:0.5rem;}

.sidebar button{
  width:100%;
  padding:0.5rem;
  margin-bottom:0.5rem;
  border:none;
  background:var(--secondary);
  cursor:pointer;
  border-radius:4px;
}

.sidebar button:hover{background:#e0e0e0;}

.main{padding:1rem;}

.snapshot{
  background:white;
  padding:1rem;
  border-radius:6px;
  box-shadow:0 2px 5px rgba(0,0,0,0.05);
  margin-bottom:1rem;
}

.badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:20px;
  background:var(--accent);
  color:white;
  font-size:12px;
  margin-right:5px;
}

.tabs{display:flex;overflow-x:auto;gap:0.5rem;margin-bottom:1rem;}

.tabs button{
  padding:0.5rem 1rem;
  border:none;
  background:#ddd;
  border-radius:20px;
  cursor:pointer;
  white-space:nowrap;
}

.tabs button.active{background:var(--primary);color:white;}

.tab-content{
  background:white;
  padding:1rem;
  border-radius:6px;
  box-shadow:0 2px 5px rgba(0,0,0,0.05);
}

.card{margin-bottom:1rem;}
.card h4{margin-bottom:0.5rem;color:var(--primary);}

ul{padding-left:1rem;margin-top:0.5rem;}

.ph-meter{
  height:20px;
  background:linear-gradient(to right, red, orange, yellow, green, blue);
  border-radius:20px;
  position:relative;
  margin-top:10px;
}

.ph-indicator{
  width:3px;
  height:30px;
  background:black;
  position:absolute;
  top:-5px;
}

.accordion{
  background:#e8f5e9;
  border:none;
  padding:10px;
  width:100%;
  text-align:left;
  cursor:pointer;
  margin-top:5px;
  border-radius:5px;
  font-weight:bold;
}

.panel{
  display:none;
  padding:10px;
  border-left:3px solid var(--primary);
  background:#f9f9f9;
}

footer{text-align:center;padding:1rem;font-size:0.8rem;color:#777;}

@media(min-width:768px){
  .container{flex-direction:row;}
  .sidebar{width:250px;border-right:1px solid #ddd;border-bottom:none;}
  .main{flex:1;}
}
</style>
</head>
<body>

<header>
  <h1 id="headerTitle">Agri Knowledge Base ‚Äì Pune Region</h1>
  <div class="top-controls">
    <input type="text" id="searchBox" placeholder="Search crop...">
    <button class="lang-toggle" onclick="toggleLanguage()">‡§Æ‡§∞‡§æ‡§†‡•Ä</button>
  </div>
</header>

<div class="container">

  <div class="sidebar">
    <h3>Crops</h3>
    <div id="cropList"></div>
  </div>

  <div class="main">
    <div id="snapshot" class="snapshot"></div>
    <canvas id="yieldChart" height="100"></canvas>
    <div id="tabs" class="tabs"></div>
    <div id="tabContent" class="tab-content"></div>
  </div>

</div>

<footer>
  Designed for Pune Region Farmers | Upgraded Phase
</footer>

<script>

let currentLang = "en";

const translations = {
  header:{en:"Agri Knowledge Base ‚Äì Pune Region",mr:"‡§ï‡•É‡§∑‡•Ä ‡§ú‡•ç‡§û‡§æ‡§® ‡§≠‡§æ‡§Ç‡§°‡§æ‡§∞ ‚Äì ‡§™‡•Å‡§£‡•á ‡§µ‡§ø‡§≠‡§æ‡§ó"},
  crops:{en:"Crops",mr:"‡§™‡§ø‡§ï‡•á"},
  searchPlaceholder:{en:"Search crop...",mr:"‡§™‡•Ä‡§ï ‡§∂‡•ã‡§ß‡§æ..."},
  footer:{en:"Designed for Pune Region Farmers | Upgraded Phase",mr:"‡§™‡•Å‡§£‡•á ‡§µ‡§ø‡§≠‡§æ‡§ó‡§æ‡§§‡•Ä‡§≤ ‡§∂‡•á‡§§‡§ï‡§±‡•ç‡§Ø‡§æ‡§Ç‡§∏‡§æ‡§†‡•Ä ‡§°‡§ø‡§ù‡§æ‡§á‡§® | ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡§§ ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡•Ä"},
  tabs:{
    overview:{en:"Overview",mr:"‡§Ü‡§¢‡§æ‡§µ‡§æ"},
    soilClimate:{en:"Soil & Climate",mr:"‡§Æ‡§æ‡§§‡•Ä ‡§µ ‡§π‡§µ‡§æ‡§Æ‡§æ‡§®"},
    water:{en:"Water",mr:"‡§™‡§æ‡§£‡•Ä ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§®"},
    nutrients:{en:"Nutrients",mr:"‡§Ö‡§®‡•ç‡§®‡§¶‡•ç‡§∞‡§µ‡•ç‡§Ø‡•á"},
    pests:{en:"Pests & Diseases",mr:"‡§ï‡•Ä‡§° ‡§µ ‡§∞‡•ã‡§ó"},
    calendar:{en:"Calendar",mr:"‡§™‡•Ä‡§ï ‡§¶‡§ø‡§®‡§¶‡§∞‡•ç‡§∂‡§ø‡§ï‡§æ"},
    varieties:{en:"Varieties",mr:"‡§ú‡§æ‡§§‡•Ä"},
    economics:{en:"Economics",mr:"‡§Ö‡§∞‡•ç‡§•‡§ï‡§æ‡§∞‡§£"},
    postHarvest:{en:"Post Harvest",mr:"‡§ï‡§æ‡§™‡§£‡•Ä‡§®‡§Ç‡§§‡§∞ ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§®"},
    doDont:{en:"Do & Don't",mr:"‡§ï‡§∞‡§æ ‡§µ ‡§ü‡§æ‡§≥‡§æ"}
  }
};

const crops = [{
  id:"onion",
  name:{en:"Onion",mr:"‡§ï‡§æ‡§Ç‡§¶‡§æ"},
  localName:{en:"Kanda",mr:"‡§ï‡§æ‡§Ç‡§¶‡§æ"},
  scientific:"Allium cepa",
  duration:{en:"110‚Äì130 days",mr:"110‚Äì130 ‡§¶‡§ø‡§µ‡§∏"},
  season:{en:"Kharif & Rabi",mr:"‡§ñ‡§∞‡•Ä‡§™ ‡§µ ‡§∞‡§¨‡•ç‡§¨‡•Ä"},
  water:{en:"Moderate",mr:"‡§Æ‡§ß‡•ç‡§Ø‡§Æ"},
  soil:{en:"Loamy, Well-drained",mr:"‡§≠‡•Å‡§∏‡§≠‡•Å‡§∂‡•Ä‡§§, ‡§ö‡§æ‡§Ç‡§ó‡§≤‡§æ ‡§®‡§ø‡§ö‡§∞‡§æ ‡§π‡•ã‡§£‡§æ‡§∞‡•Ä"},
  yield:{en:"250‚Äì350 q/ha",mr:"250‚Äì350 ‡§ï‡•ç‡§µ‡§ø‡§Ç‡§ü‡§≤/‡§π‡•á"},
  soilPHValue:6.5,

  overview:{
    type:{en:"Biennial grown as annual",mr:"‡§¶‡•ç‡§µ‡§ø‡§µ‡§∞‡•ç‡§∑‡§æ‡§Ø‡•Ç ‡§™‡§£ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§™‡§ø‡§ï ‡§Æ‡•ç‡§π‡§£‡•Ç‡§® ‡§ò‡•á‡§§‡§≤‡•á ‡§ú‡§æ‡§§‡•á"},
    ediblePart:{en:"Bulb",mr:"‡§ó‡§æ‡§†‡•Ä (‡§ï‡§Ç‡§¶)"},
    rootSystem:{en:"Fibrous",mr:"‡§§‡§Ç‡§§‡•Å‡§Æ‡§Ø"}
  },

  soilClimate:{
    soilPH:{en:"6.0 ‚Äì 7.5",mr:"6.0 ‚Äì 7.5"},
    rainfall:{en:"500‚Äì750 mm",mr:"500‚Äì750 ‡§Æ‡§ø‡§Æ‡•Ä"},
    temperature:{en:"13‚Äì25¬∞C optimal",mr:"13‚Äì25¬∞C ‡§Ø‡•ã‡§ó‡•ç‡§Ø"},
    drainage:{en:"Excellent drainage required",mr:"‡§â‡§§‡•ç‡§§‡§Æ ‡§®‡§ø‡§ö‡§∞‡§æ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï"}
  },

  waterManagement:{
    totalWater:{en:"350‚Äì550 mm",mr:"350‚Äì550 ‡§Æ‡§ø‡§Æ‡•Ä"},
    criticalStages:{
      en:["Bulb initiation","Bulb enlargement"],
      mr:["‡§ï‡§Ç‡§¶ ‡§§‡§Ø‡§æ‡§∞ ‡§π‡•ã‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ","‡§ï‡§Ç‡§¶ ‡§µ‡§æ‡§¢ ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ"]
    },
    irrigationInterval:{en:"5‚Äì10 days depending on stage",mr:"5‚Äì10 ‡§¶‡§ø‡§µ‡§∏‡§æ‡§Ç‡§ö‡•ç‡§Ø‡§æ ‡§Ö‡§Ç‡§§‡§∞‡§æ‡§®‡•á"},
    caution:{en:"Avoid waterlogging",mr:"‡§™‡§æ‡§£‡•Ä ‡§∏‡§æ‡§ö‡•Ç ‡§¶‡•á‡§ä ‡§®‡§Ø‡•á"}
  },

  nutrients:{
    NPK:{en:"100:50:50 kg/ha",mr:"100:50:50 ‡§ï‡§ø.‡§ó‡•ç‡§∞‡§æ./‡§π‡•á"},
    organic:{en:"FYM 20‚Äì25 tons/ha",mr:"‡§∂‡•á‡§£‡§ñ‡§§ 20‚Äì25 ‡§ü‡§®/‡§π‡•á"},
    sulphur:{en:"20‚Äì25 kg/ha improves bulb quality",mr:"20‚Äì25 ‡§ï‡§ø.‡§ó‡•ç‡§∞‡§æ./‡§π‡•á ‡§ó‡§Ç‡§ß‡§ï ‚Äì ‡§ï‡§Ç‡§¶ ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡•á‡§∏‡§æ‡§†‡•Ä"},
    schedule:{en:"Split nitrogen application",mr:"‡§®‡§§‡•ç‡§∞‡§æ‡§ö‡•á ‡§µ‡§ø‡§≠‡§æ‡§ó‡•Ç‡§® ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ ‡§¶‡•ç‡§Ø‡§æ‡§µ‡•á"}
  },

  pestsDiseases:{
    pests:[{
      name:{en:"Thrips",mr:"‡§•‡•ç‡§∞‡§ø‡§™‡•ç‡§∏"},
      detail:{en:"Thrips tabaci ‚Äì Silver streaks on leaves. ETL: 30 thrips/plant. Control: Spinosad 0.3 ml/L",
              mr:"Thrips tabaci ‚Äì ‡§™‡§æ‡§®‡§æ‡§Ç‡§µ‡§∞ ‡§∞‡•Å‡§™‡•á‡§∞‡•Ä ‡§™‡§ü‡•ç‡§ü‡•á. ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£: ‡§∏‡•ç‡§™‡§ø‡§®‡•ã‡§∏‡•Ö‡§° 0.3 ‡§Æ‡§ø.‡§≤‡•Ä./‡§≤‡§ø."}
    }],
    diseases:[{
      name:{en:"Purple Blotch",mr:"‡§ú‡§æ‡§Ç‡§≠‡§≥‡§æ ‡§°‡§æ‡§ó ‡§∞‡•ã‡§ó"},
      detail:{en:"Alternaria porri ‚Äì Purple lesions. Spray Mancozeb 2.5 g/L",
              mr:"Alternaria porri ‚Äì ‡§ú‡§æ‡§Ç‡§≠‡§≥‡•á ‡§°‡§æ‡§ó. ‡§Æ‡•Ö‡§®‡•ç‡§ï‡•ã‡§ù‡•á‡§¨ 2.5 ‡§ó‡•ç‡§∞‡•Ö./‡§≤‡§ø ‡§´‡§µ‡§æ‡§∞‡§£‡•Ä"}
    }]
  },

  calendar:{
    en:[
      "June‚ÄìJuly: Nursery sowing (Kharif)",
      "July‚ÄìAug: Transplanting",
      "Aug‚ÄìSept: Top dressing & weeding",
      "Oct‚ÄìNov: Harvest (Kharif)",
      "Dec‚ÄìJan: Rabi transplanting",
      "March‚ÄìApril: Rabi harvest"
    ],
    mr:[
      "‡§ú‡•Ç‡§®‚Äì‡§ú‡•Å‡§≤‡•à: ‡§∞‡•ã‡§™‡§µ‡§æ‡§ü‡§ø‡§ï‡§æ ‡§™‡•á‡§∞‡§£‡•Ä (‡§ñ‡§∞‡•Ä‡§™)",
      "‡§ú‡•Å‡§≤‡•à‚Äì‡§ë‡§ó‡§∏‡•ç‡§ü: ‡§™‡•Å‡§®‡§∞‡•ç‡§≤‡§æ‡§ó‡§µ‡§°",
      "‡§ë‡§ó‡§∏‡•ç‡§ü‚Äì‡§∏‡§™‡•ç‡§ü‡•á‡§Ç‡§¨‡§∞: ‡§ñ‡§§‡•á ‡§µ ‡§§‡§£ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£",
      "‡§ë‡§ï‡•ç‡§ü‡•ã‚Äì‡§®‡•ã‡§µ‡•ç‡§π‡•á‡§Ç: ‡§ñ‡§∞‡•Ä‡§™ ‡§ï‡§æ‡§¢‡§£‡•Ä",
      "‡§°‡§ø‡§∏‡•á‡§Ç‚Äì‡§ú‡§æ‡§®‡•á: ‡§∞‡§¨‡•ç‡§¨‡•Ä ‡§≤‡§æ‡§ó‡§µ‡§°",
      "‡§Æ‡§æ‡§∞‡•ç‡§ö‚Äì‡§è‡§™‡•ç‡§∞‡§ø‡§≤: ‡§∞‡§¨‡•ç‡§¨‡•Ä ‡§ï‡§æ‡§¢‡§£‡•Ä"
    ]
  },

  varieties:{
    en:["N-53","Baswant-780","Agrifound Light Red"],
    mr:["‡§è‡§®-53","‡§¨‡§∏‡§µ‡§Ç‡§§-780","‡§Ö‡•Ö‡§ó‡•ç‡§∞‡•Ä‡§´‡§æ‡§â‡§Ç‡§° ‡§≤‡§æ‡§à‡§ü ‡§∞‡•á‡§°"]
  },

  economics:{
    cost:{en:"‚Çπ1.2‚Äì1.5 lakh/ha",mr:"‚Çπ1.2‚Äì1.5 ‡§≤‡§æ‡§ñ/‡§π‡•á"},
    storage:{en:"4‚Äì6 months (Rabi)",mr:"4‚Äì6 ‡§Æ‡§π‡§ø‡§®‡•á (‡§∞‡§¨‡•ç‡§¨‡•Ä)"},
    marketPeak:{en:"May‚ÄìJune",mr:"‡§Æ‡•á‚Äì‡§ú‡•Ç‡§®"}
  },

  postHarvest:{
    curing:{en:"7‚Äì10 days shade curing",mr:"7‚Äì10 ‡§¶‡§ø‡§µ‡§∏ ‡§∏‡§æ‡§µ‡§≤‡•Ä‡§§ ‡§µ‡§æ‡§≥‡§µ‡§£‡•á"},
    storageTemp:{en:"25‚Äì30¬∞C",mr:"25‚Äì30¬∞C"},
    humidity:{en:"65‚Äì70%",mr:"65‚Äì70%"}
  },

  doDont:{
    do:{
      en:["Use certified seed","Ensure proper drainage","Split nitrogen application"],
      mr:["‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§ø‡§§ ‡§¨‡§ø‡§Ø‡§æ‡§£‡•á ‡§µ‡§æ‡§™‡§∞‡§æ","‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§®‡§ø‡§ö‡§∞‡§æ ‡§†‡•á‡§µ‡§æ","‡§®‡§§‡•ç‡§∞ ‡§µ‡§ø‡§≠‡§æ‡§ó‡•Ç‡§® ‡§¶‡•ç‡§Ø‡§æ"]
    },
    dont:{
      en:["Avoid over irrigation","Avoid continuous onion cropping","Avoid excess nitrogen late stage"],
      mr:["‡§Ö‡§§‡§ø ‡§™‡§æ‡§£‡•Ä ‡§¶‡•á‡§ä ‡§®‡§ï‡§æ","‡§∏‡§§‡§§ ‡§ï‡§æ‡§Ç‡§¶‡§æ ‡§™‡•Ä‡§ï ‡§ò‡•á‡§ä ‡§®‡§ï‡§æ","‡§∂‡•á‡§µ‡§ü‡§ö‡•ç‡§Ø‡§æ ‡§Ö‡§µ‡§∏‡•ç‡§•‡•á‡§§ ‡§ú‡§æ‡§∏‡•ç‡§§ ‡§®‡§§‡•ç‡§∞ ‡§ü‡§æ‡§≥‡§æ"]
    }
  }

}];

const cropList = document.getElementById("cropList");
const snapshot = document.getElementById("snapshot");
const tabs = document.getElementById("tabs");
const tabContent = document.getElementById("tabContent");

function loadCrop(crop){

  snapshot.innerHTML = `
    <h2>üßÖ ${crop.name[currentLang]} (${crop.localName[currentLang]})</h2>
    <p><strong>Scientific:</strong> ${crop.scientific}</p>
    <span class="badge">${currentLang==='en'?'Season':'‡§π‡§Ç‡§ó‡§æ‡§Æ'}: ${crop.season[currentLang]}</span>
    <span class="badge">${currentLang==='en'?'Duration':'‡§ï‡§æ‡§≤‡§æ‡§µ‡§ß‡•Ä'}: ${crop.duration[currentLang]}</span>
    <p><strong>${currentLang==='en'?'Soil':'‡§Æ‡§æ‡§§‡•Ä'}:</strong> ${crop.soil[currentLang]}</p>
    <p><strong>${currentLang==='en'?'Water':'‡§™‡§æ‡§£‡•Ä'}:</strong> ${crop.water[currentLang]}</p>
    <p><strong>${currentLang==='en'?'Yield':'‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§®'}:</strong> ${crop.yield[currentLang]}</p>
  `;

  const phPosition = (crop.soilPHValue/14)*100;

  const sections = {
    [translations.tabs.overview[currentLang]]:`
      <div class="card">
        <p><strong>${currentLang==='en'?'Type':'‡§™‡•ç‡§∞‡§ï‡§æ‡§∞'}:</strong> ${crop.overview.type[currentLang]}</p>
        <p><strong>${currentLang==='en'?'Edible Part':'‡§ñ‡§æ‡§¶‡•ç‡§Ø ‡§≠‡§æ‡§ó'}:</strong> ${crop.overview.ediblePart[currentLang]}</p>
        <p><strong>${currentLang==='en'?'Root System':'‡§Æ‡•Å‡§≥‡§æ‡§Ç‡§ö‡•Ä ‡§∞‡§ö‡§®‡§æ'}:</strong> ${crop.overview.rootSystem[currentLang]}</p>
      </div>
    `,
    [translations.tabs.soilClimate[currentLang]]:`
      <div class="card">
        <p><strong>pH:</strong> ${crop.soilClimate.soilPH[currentLang]}</p>
        <div class="ph-meter"><div class="ph-indicator" style="left:${phPosition}%;"></div></div>
        <p><strong>${currentLang==='en'?'Rainfall':'‡§™‡§∞‡•ç‡§ú‡§®‡•ç‡§Ø‡§Æ‡§æ‡§®'}:</strong> ${crop.soilClimate.rainfall[currentLang]}</p>
        <p><strong>${currentLang==='en'?'Temperature':'‡§§‡§æ‡§™‡§Æ‡§æ‡§®'}:</strong> ${crop.soilClimate.temperature[currentLang]}</p>
        <p><strong>${currentLang==='en'?'Drainage':'‡§®‡§ø‡§ö‡§∞‡§æ'}:</strong> ${crop.soilClimate.drainage[currentLang]}</p>
      </div>
    `,
    [translations.tabs.water[currentLang]]:`
      <div class="card">
        <p><strong>${currentLang==='en'?'Total Water':'‡§è‡§ï‡•Ç‡§£ ‡§™‡§æ‡§£‡•Ä'}:</strong> ${crop.waterManagement.totalWater[currentLang]}</p>
        <p><strong>${currentLang==='en'?'Irrigation Interval':'‡§™‡§æ‡§£‡•Ä ‡§¶‡•á‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§Ö‡§Ç‡§§‡§∞'}:</strong> ${crop.waterManagement.irrigationInterval[currentLang]}</p>
        <ul>${crop.waterManagement.criticalStages[currentLang].map(s=>`<li>${s}</li>`).join("")}</ul>
        <p><strong>${currentLang==='en'?'Caution':'‡§∏‡•Ç‡§ö‡§®‡§æ'}:</strong> ${crop.waterManagement.caution[currentLang]}</p>
      </div>
    `,
    [translations.tabs.nutrients[currentLang]]:`
      <div class="card">
        <p><strong>NPK:</strong> ${crop.nutrients.NPK[currentLang]}</p>
        <p><strong>${currentLang==='en'?'Organic':'‡§∏‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§Ø'}:</strong> ${crop.nutrients.organic[currentLang]}</p>
        <p><strong>${currentLang==='en'?'Sulphur':'‡§ó‡§Ç‡§ß‡§ï'}:</strong> ${crop.nutrients.sulphur[currentLang]}</p>
        <p><strong>${currentLang==='en'?'Schedule':'‡§µ‡•á‡§≥‡§æ‡§™‡§§‡•ç‡§∞‡§ï'}:</strong> ${crop.nutrients.schedule[currentLang]}</p>
      </div>
    `,
    [translations.tabs.pests[currentLang]]:`
      ${crop.pestsDiseases.pests.map(p=>`
        <button class="accordion">${p.name[currentLang]}</button>
        <div class="panel"><p>${p.detail[currentLang]}</p></div>
      `).join("")}
      ${crop.pestsDiseases.diseases.map(d=>`
        <button class="accordion">${d.name[currentLang]}</button>
        <div class="panel"><p>${d.detail[currentLang]}</p></div>
      `).join("")}
    `,
    [translations.tabs.calendar[currentLang]]:`<ul>${crop.calendar[currentLang].map(c=>`<li>${c}</li>`).join("")}</ul>`,
    [translations.tabs.varieties[currentLang]]:`<ul>${crop.varieties[currentLang].map(v=>`<li>${v}</li>`).join("")}</ul>`,
    [translations.tabs.economics[currentLang]]:`
      <p><strong>${currentLang==='en'?'Cost':'‡§ñ‡§∞‡•ç‡§ö'}:</strong> ${crop.economics.cost[currentLang]}</p>
      <p><strong>${currentLang==='en'?'Storage':'‡§∏‡§æ‡§†‡§µ‡§£'}:</strong> ${crop.economics.storage[currentLang]}</p>
      <p><strong>${currentLang==='en'?'Market Peak':'‡§¨‡§æ‡§ú‡§æ‡§∞‡§æ‡§§‡•Ä‡§≤ ‡§ú‡§æ‡§∏‡•ç‡§§ ‡§Æ‡§æ‡§ó‡§£‡•Ä'}:</strong> ${crop.economics.marketPeak[currentLang]}</p>
    `,
    [translations.tabs.postHarvest[currentLang]]:`
      <p><strong>${currentLang==='en'?'Curing':'‡§µ‡§æ‡§≥‡§µ‡§£‡•á'}:</strong> ${crop.postHarvest.curing[currentLang]}</p>
      <p><strong>${currentLang==='en'?'Storage Temp':'‡§∏‡§æ‡§†‡§µ‡§£ ‡§§‡§æ‡§™‡§Æ‡§æ‡§®'}:</strong> ${crop.postHarvest.storageTemp[currentLang]}</p>
      <p><strong>${currentLang==='en'?'Humidity':'‡§Ü‡§∞‡•ç‡§¶‡•ç‡§∞‡§§‡§æ'}:</strong> ${crop.postHarvest.humidity[currentLang]}</p>
    `,
    [translations.tabs.doDont[currentLang]]:`
      <div style="display:flex;gap:2rem;">
        <div><h4 style="color:green;">${currentLang==='en'?'Do':'‡§ï‡§∞‡§æ'}</h4><ul>${crop.doDont.do[currentLang].map(d=>`<li>${d}</li>`).join("")}</ul></div>
        <div><h4 style="color:red;">${currentLang==='en'?'Don\'t':'‡§ü‡§æ‡§≥‡§æ'}</h4><ul>${crop.doDont.dont[currentLang].map(d=>`<li>${d}</li>`).join("")}</ul></div>
      </div>
    `
  };

  tabs.innerHTML="";
  tabContent.innerHTML="";

  Object.keys(sections).forEach((key,index)=>{
    const btn=document.createElement("button");
    btn.innerText=key;
    if(index===0){btn.classList.add("active");tabContent.innerHTML=sections[key];}
    btn.onclick=()=>{
      document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      tabContent.innerHTML=sections[key];
      initAccordion();
    };
    tabs.appendChild(btn);
  });

  initAccordion();
  initChart();
}

function initAccordion(){
  const acc = document.getElementsByClassName("accordion");
  for (let i = 0; i < acc.length; i++) {
    acc[i].onclick=function(){
      const panel=this.nextElementSibling;
      panel.style.display=panel.style.display==="block"?"none":"block";
    };
  }
}

function initChart(){
  const ctx=document.getElementById('yieldChart').getContext('2d');
  new Chart(ctx,{type:'line',data:{labels:['2019','2020','2021','2022','2023'],datasets:[{label:'Yield (q/ha)',data:[240,260,250,275,290],borderColor:'#2e7d32',fill:false}]}});
}

function toggleLanguage(){
  currentLang=currentLang==='en'?'mr':'en';
  document.querySelector('.lang-toggle').innerText=currentLang==='en'?'‡§Æ‡§∞‡§æ‡§†‡•Ä':'English';
  document.getElementById('headerTitle').innerText=translations.header[currentLang];
  document.querySelector('.sidebar h3').innerText=translations.crops[currentLang];
  document.getElementById('searchBox').placeholder=translations.searchPlaceholder[currentLang];
  document.querySelector('footer').innerText=translations.footer[currentLang];
  loadCrop(crops[0]);
}

crops.forEach(c=>{
  const btn=document.createElement("button");
  btn.innerText=c.name.en;
  btn.onclick=()=>loadCrop(c);
  cropList.appendChild(btn);
});

loadCrop(crops[0]);

</script>

</body>
</html>
